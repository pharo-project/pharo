"
Removes a variable from a class. It does not remove it if there is a direct access to this variable in the class.

Usage:

```
transformation := (RBRemoveVariableTransformation 
	variable: 'isClassVariable'
	class: #RBVariableTransformation
	classVariable: false)
	transform. 
(ChangesBrowser changes: transformation model changes changes) open
```

Preconditions:
- the class exists
- the class defines a variable with the given name
"
Class {
	#name : #RBRemoveVariableTransformation,
	#superclass : #RBVariableTransformation,
	#category : #'Refactoring2-Transformations-Model-Unused'
}

{ #category : #preconditions }
RBRemoveVariableTransformation >> applicabilityPreconditions [ 

	class := self definingClass.

	^ isClassVariable
		ifTrue: [ self applicabilityPreconditionsForClassVariable ]
		ifFalse: [ self applicabilityPreconditionsForInstanceVariable ]
]

{ #category : #preconditions }
RBRemoveVariableTransformation >> applicabilityPreconditionsForClassVariable [

	^ (RBCondition isMetaclass: class) not
	  & (RBCondition definesClassVariable: variableName in: class)
]

{ #category : #preconditions }
RBRemoveVariableTransformation >> applicabilityPreconditionsForInstanceVariable [
	"For now only remove an instance variable that is locally defined in a class."
	
	^ (RBCondition directlyDefinesInstanceVariable: variableName asString in: class)
]

{ #category : #preconditions }
RBRemoveVariableTransformation >> breakingChangePreconditionsForClassVariable [

	^ RBCondition
		  accessesClassVariable: variableName
		  in: class
		  showIn: self
]

{ #category : #preconditions }
RBRemoveVariableTransformation >> breakingChangePreconditionsForInstanceVariable [

	^ (RBCondition doesNotAccessInstanceVariable: variableName inHierarchyOf: class showIn: self)
]

{ #category : #executing }
RBRemoveVariableTransformation >> privateTransform [

	isClassVariable
		ifTrue: [ self definingClass instanceSide removeClassVariable: variableName ]
		ifFalse: [ self definingClass removeInstanceVariable: variableName ]
]
